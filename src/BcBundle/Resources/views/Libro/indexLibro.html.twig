{% extends "BcBundle::layout.html.twig" %}
{% block content %}
    {% if app.user != null %} 
        {% if app.user.rol != null %}
            <br>
            <div class="container bg-dark">
                <br>
                <div class="row">
                    <div class="col-md-6">
                        <a href="{{path("bc_add_libro")}}"><input type="button" value="Proponer libro" class="btn btn-warning"></a>
                    </div>
                    <div class="col-md-6">
                        <input id="act_busq" type="button" value="¿Buscas algo?" class="btn btn-warning">
                        {% if app.user.rol == 'ADMIN' %}
                            <a href="{{path("bc_index_NoVallibro")}}">
                                <input type="button" value="Libros NO validados" class="btn btn-danger">
                            </a>
                        {% endif %} 
                    </div>
                </div>
                <br>
            </div>
            <br>
            <div id="busq_libro" class="container bg-info">
                <br>
                <div id="controlBusqueda" class="row">
                    <div class="col-md-6">
                        <h3><b>Búsqueda de libro</b></h3>
                    </div>
                    <div class="col-md-6">
                        <table style="width: 75%">
                            <form accept-charset="utf-8" method="POST">
                                <tr>
                                    <td><b>Seleccione el parámetro de búsqueda : </b><br>
                                        <select name="ParamBusq">
                                            <option value="nada"></option>
                                            <option value="titulo">Libro</option>
                                            <option value="autor">Autor</option>
                                            <option value="categoria">Categoría</option>
                                            <option value="libreria">Localización de su librería</option>
                                            <option value="fecha">Fecha</option>
                                        </select>
                                    </td>
                                </tr>             
                                <tr>
                                    <td ><b>Texto de clave : </b><br>
                                        <input type="text" id="parametroBusqueda" value="" placeholder="" maxlength="30" autocomplete="off" />
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <br><input id="activarBusqueda" type="button" value="Buscar.." class="btn btn-dark"><input id="cancelarBusqueda" type="button" value="Cancelar" class="btn btn-danger">
                                    </td>
                                </tr>
                            </form>
                        </table>
                    </div>
                </div>
                <br>
            </div>
            <br>
            {% for libro in libros %}
                <!--LIBROS VALIDADOS -->
                {% if libro.validacion == 1 %}
                    <div class="container bg-warning">
                        <br>
                        <h2 id="titleLibro">
                            <i class="fas fa-arrow-alt-circle-right"></i><b><a href="{{path("bc_perfil_libro",{"id":libro.idLibro})}}"> {{libro.titulo}}</a></b>
                        </h2>
                        <br>
                        <div class="row">
                            <div class="col-md-4 text-center">
                                <br>
                                {% if libro.portada == null or libro.portada == "" %}
                                    <img src="{{asset("imgdata/smile.png")}}" height="230" width="200"> 
                                {% else %}
                                    <img src="{{asset(libro.portada)}}" height="230" width="200"> 
                                {% endif %}
                                {% if app.user.rol == 'ADMIN' %} 
                                    <br><br>
                                    <div class="row">
                                        <div class="col-md-2"></div>
                                        <div class="col-md-3">
                                            <a href="{{path("bc_delete_libro",{"id":libro.idLibro})}}">
                                                <i class="fas fa-trash" style="font-size: 250%">   
                                                </i>
                                            </a>
                                        </div>
                                        <div class="col-md-3">
                                            <a href="{{path("bc_edit_libro",{"id":libro.idLibro})}}">
                                                <i class="fas fa-pencil-alt" style="font-size: 250%">
                                                </i>
                                            </a>
                                        </div>
                                        <div class="col-md-3">
                                            <a href="">
                                                <i class="fas fa-plus" style="font-size: 250%"></i><b>Lista</b>
                                            </a>
                                        </div>
                                    </div>
                                    <br><br>
                                {% endif %}
                            </div>
                            <div class="col-md-8">
                                <br><br>
                                <h4><b>Por "</b><i>{{libro.autor}}</i><b>"</b> </h4>
                                <table class="bg-success" style="width: 75%">
                                    <tr>
                                        <td>
                                            <b>Publicado el </b> {{libro.fechpublic|date('d-m-Y')}}
                                        </td>
                                        <td>
                                            {% if libro.formato == 0 %}
                                                <b> Formato : </b> Físico 
                                            {% elseif libro.formato == 1 %}
                                                <b> Formato : </b> Digital
                                            {% else %}
                                                <b> Formato :</b> Digital y físico.
                                            {% endif %}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <b>Categoría : "{{libro.categoria}}"</b>
                                        </td>
                                    </tr>
                                </table>
                                <br>
                                <b>Disponible en : </b>
                                <div id="list_tiendas">
                                    <ul>
                                        <li><a href="{{path("bc_index_stocks",{"id":libro.idLibro})}}"><i class="fas fa-eye"></i><b> Ver librerías..</b></a></li>
                                        <br><br>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br><br> 
                {% endif %}
            {% endfor %}
        {% else %}
            <div class="container bg-danger">
                <div class="row">
                    <div class="col-md-3">
                    </div>
                    <div class="col-md-5" align="center">
                        <br><br>
                        <h1>¡Alto ahí, forastero! ¡Debes inscribirte primero para entrar a esta sección!</h1>
                        <br><br>
                    </div>
                </div>
            </div>
        {% endif %}
    {% else %}
        <div class="container bg-danger">
            <div class="row">
                <div class="col-md-3">
                </div>
                <div class="col-md-5" align="center">
                    <br><br>
                    <h1>¡Alto ahí, forastero! ¡Debes inscribirte primero para entrar a esta sección!</h1>
                    <br><br>
                </div>
            </div>
        </div>
    {% endif %}
    <br>
{% endblock %}
{% block javascript %}
    <script src="{{ asset('assets/js/function.js') }}" type="text/javascript"></script>
    <script>
        $(document).ready(function () {
            $("#controlBusqueda").toggle();

            $("#act_busq").click(function () {
                $("#controlBusqueda").toggle();
            });
        });
    </script>
{% endblock %}
